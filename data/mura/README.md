# MURA - MUsculoskeletal RAdiographs Dataset

## Dataset Information
- **Source:** Stanford ML Group
- **Paper:** Rajpurkar et al., "MURA: Large Dataset for Abnormality Detection in Musculoskeletal Radiographs"
- **Images:** 40,561 multi-view radiographic images
- **Body Parts:** Elbow, Finger, Forearm, Hand, Humerus, Shoulder, Wrist
- **Task:** Detect abnormalities in musculoskeletal X-rays

## Download Instructions

1. **Request Access:**
   - Visit: https://stanfordmlgroup.github.io/competitions/mura/
   - Register and request dataset access

2. **Download:**
   - Download `MURA-v1.1.zip` (~3.3GB)

3. **Extract:**
   ```bash
   cd data/mura
   unzip MURA-v1.1.zip
   ```

## Directory Structure

```
data/mura/
├── MURA-v1.1/
│   ├── train/
│   │   ├── XR_ELBOW/
│   │   ├── XR_FINGER/
│   │   ├── XR_FOREARM/
│   │   ├── XR_HAND/
│   │   ├── XR_HUMERUS/
│   │   ├── XR_SHOULDER/
│   │   └── XR_WRIST/
│   └── valid/
│       └── [same structure]
└── processed/          # Generated by prepare_mura.py
    ├── mura_valid_calibration.csv
    ├── mura_valid_test.csv
    ├── mura_train_calibration.csv
    └── mura_train_test.csv
```

## Prepare for Conformal Prediction

```bash
python scripts/prepare_mura.py
```

This creates stratified calibration and test sets by body part.

## Usage

```python
from uncertainty_module.data.mura_loader import get_mura_loaders

cal_loader, test_loader = get_mura_loaders("data/mura")

# Use with conformal prediction
from uncertainty_module.core.conformal import ConformalPredictor

cp = ConformalPredictor(alpha=0.05)
cp.calibrate(model, cal_loader)
```

## Statistics

| Split | Images | Abnormal Rate |
|-------|--------|---------------|
| Train | ~37k | ~45% |
| Valid | ~3.2k | ~45% |

## Citation

```bibtex
@article{rajpurkar2017mura,
  title={MURA: Large Dataset for Abnormality Detection in Musculoskeletal Radiographs},
  author={Rajpurkar, Pranav and Irvin, Jeremy and Bagul, Aarti and Ding, Daisy and Duan, Tenzing and Mehta, Hershel and Yang, Brandon and Zhu, Kaylie and Laird, Dillon and Ball, Robyn L and others},
  journal={arXiv preprint arXiv:1712.06957},
  year={2017}
}
```
